var paging_url='/shop/paging';function paging_cb(e){var _node='<div class="list-box pr">'+$('.list-box').html()+'</div>',_wrap=$('.list-wrap'),data=JSON.parse(e).goods_list;_wrap.html('');for(i=0;i<data.length;i++){_wrap.append(_node);$('.goods_img').eq(i).attr('src',data[i].goods_img);$('.goods_downloadNum').eq(i).text(data[i].goods_download_num);$('.goods_markNum').eq(i).text(data[i].goods_markNum);$('.goods_name').eq(i).text(data[i].goods_name);$('.goods_price').eq(i).text('￥'+data[i].goods_price);if(data[i].goods_mark){$('.list-mark-btn').addClass('active');}}
setDataInList();}
$(function(){setDataInList();})
function setDataInList(){var filter_btn=$('.filter-btn'),classify_btn=$('.classify-btn'),list_wrap=$('.list-wrap'),guide_btn=$('.classify-guide'),classify_nav_box=$('.classify-nav-box'),_kind=list_wrap.attr('data-kind'),list_mark_btn=$('.list-mark-btn'),_node="<div class='list-box pr'>"+$('.list-box').html()+"</div>";filter_btn.on('click',function(){var _this=$(this),_filter=_this.attr('data-tag'),_classify=classify_btn.filter('.active').attr('data-tag');clickFocus(_this);$.post('/shop/getGoods/filter',{list_type:_kind,filter_type:_filter,classify_type:_classify},function(e){e=JSON.parse(e).goods_list;list_wrap.html('');for(var i=0;i<e.length;i++){list_wrap.append(_node);$('#paging').attr('paging-total',e.page_length);$('.list-box').eq(i).find('.goods_img').attr('src',e[i].goods_img);$('.list-box').eq(i).find('.goods_downloadNum').text(e[i].goods_download_num);$('.list-box').eq(i).find('.goods_markNum').text(e[i].goods_mark_num);$('.list-box').eq(i).find('.goods_name').text(e[i].goods_name);$('.list-box').eq(i).find('.goods_price').text(e[i].goods_price);if(e[i].goods_mark){$('.list-box').eq(i).find('.list-mark-btn').addClass('active');}}});});classify_btn.on('click',function(){var _this=$(this),_classify=_this.attr('data-tag'),_filter=filter_btn.filter('.active').attr('data-tag');clickFocus(_this);$.post('/shop/getGoods/classify',{list_type:_kind,filter_type:_filter,classify_type:_classify},function(e){e=JSON.parse(e).goods_list;list_wrap.html('');for(var i=0;i<e.length;i++){list_wrap.append(_node);$('.list-box').eq(i).find('.goods_img').attr('src',e[i].goods_img);$('.list-box').eq(i).find('.goods_downloadNum').text(e[i].goods_download_num);$('.list-box').eq(i).find('.goods_markNum').text(e[i].goods_mark_num);$('.list-box').eq(i).find('.goods_name').text(e[i].goods_name);$('.list-box').eq(i).find('.goods_price').text(e[i].goods_price);if(e[i].goods_mark){$('.list-box').eq(i).find('.list-mark-btn').addClass('active');}}});});function clickFocus(obj){obj.siblings().removeClass('active');obj.addClass('active');}
guide_btn.on('click',function(){var _this=$(this);if(classify_nav_box.css('display')=='none'){classify_nav_box.show();classify_nav_box.animate({'margin-right':0},function(){_this.addClass('active').text('收起');$('.guide-ico').addClass('active');});}else{classify_nav_box.animate({'margin-right':'-343px'},function(){_this.removeClass('active').text('风格筛选');$('.guide-ico').removeClass('active');classify_nav_box.hide();});}});list_mark_btn.on('click',function(){var _this=$(this),_num=_this.attr('data-num');toMark(_this,_num);});function toMark(_this,id){$.post('/shop/mark-goods',{goods_id:id},function(e){var data=JSON.parse(e);if(data.state=='SUCCESS'){if(_this.hasClass('active')){_this.removeClass('active');}else{_this.addClass('active');}}else{$('.login-page').fadeIn();}});}}